(()=>{document.addEventListener("DOMContentLoaded",function(){var r=document.getElementById("search");function n(a){a.key==="Enter"&&(a.preventDefault(),fetch("/api/search",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"search="+encodeURIComponent(r?.value)}).then(t=>t.json()).then(t=>{s(t)}).catch(t=>{console.error("Error",t)}))}r.addEventListener("keypress",n)});mapboxgl.accessToken="pk.eyJ1IjoianRhcmNoaSIsImEiOiJjbHBobmx0YWQwOG01MmlxeDAydGxlN2c5In0.o3yTh6k7uo_e3CBi_32R9Q";var o=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",bounds:[[-125.0011,24.9493],[-66.9326,49.5904]]});function s(r){var n=r.flatMap(e=>e.minLat===e.maxLat&&e.minLon===e.maxLon?{type:"Feature",geometry:{type:"Point",coordinates:[e.minLon,e.minLat]}}:[{type:"Feature",geometry:{type:"Point",coordinates:[e.minLon,e.minLat]}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[e.minLon,e.minLat],[e.maxLon,e.minLat],[e.maxLon,e.maxLat],[e.minLon,e.maxLat],[e.minLon,e.minLat]]]}}]),a=o.getSource("results");a?a.setData({type:"FeatureCollection",features:n}):o.addSource("results",{type:"geojson",data:{type:"FeatureCollection",features:n}}),o.addLayer({id:"boundaries",type:"fill",source:"results",paint:{"fill-color":"#B42222"},filter:["==","$type","Polygon"]}),o.addLayer({id:"points",type:"circle",source:"results",paint:{"circle-radius":6,"circle-color":"#B42222"},filter:["==","$type","Point"]});var t=new mapboxgl.LngLatBounds;n.forEach(e=>{e.geometry.type==="Point"?t.extend(e.geometry.coordinates):e.geometry.type==="Polygon"&&e.geometry.coordinates[0].forEach(i=>{t.extend(i)})}),n.length>0&&o.fitBounds(t,{padding:20})}})();
